<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Shadow Social ‚Äî Demo Completa</title>
  <style>
    :root{ --bg:#0b0b0c; --panel:#111214; --muted:#9aa3ad; --accent:#7c5cff; --accent2:#3a9bdc; --radius:14px; --card-radius:16px; --shadow:0 8px 24px rgba(2,6,23,0.6); font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; }
    *{box-sizing:border-box} body{margin:0; min-height:100vh; background:linear-gradient(180deg,#050506,#0b0b0c); color:#e9f0f7}
    header.topbar{position:sticky;top:0;display:flex;align-items:center;justify-content:space-between;padding:12px 20px;background:#0f1012;box-shadow:var(--shadow);z-index:60}
    .brand{display:flex;gap:12px;align-items:center} .mark{width:40px;height:40px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent2));display:grid;place-items:center;font-weight:800} .brand h1{margin:0;font-size:18px} 
    .top-actions{display:flex;gap:12px;align-items:center} .icon-btn{background:transparent;border:0;color:inherit;padding:8px;border-radius:10px;cursor:pointer;font-size:18px} 
    .notif-count{position:relative} .notif-count span{position:absolute;top:-6px;right:-8px;background:var(--accent2);color:#04121a;border-radius:50%;padding:2px 6px;font-size:11px;font-weight:700} 
    main.app{max-width:1200px;margin:22px auto;padding:18px;display:grid;grid-template-columns:280px 1fr 320px;gap:20px} 
    .panel{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:14px;border-radius:var(--radius);box-shadow:var(--shadow);border:1px solid rgba(255,255,255,0.03)}
    .profile-compact{display:flex;gap:12px;align-items:center} .avatar{width:56px;height:56px;border-radius:12px;background:#101316;display:grid;place-items:center;font-weight:800;color:var(--accent)} .muted{color:var(--muted)}
    .nav-list{display:flex;flex-direction:column;gap:8px;margin-top:12px} .nav-item{padding:8px 10px;border-radius:10px;cursor:pointer} .nav-item.active{background:linear-gradient(90deg,var(--accent),var(--accent2));color:#04121a;font-weight:700} 
    .composer{display:flex;gap:12px;flex-direction:column} .composer textarea{min-height:72px;background:#0e0f11;border:1px solid rgba(255,255,255,0.03);border-radius:12px;padding:10px;color:inherit;resize:none} 
    .composer .row{display:flex;gap:8px;align-items:center} .btn{background:var(--accent);border:0;padding:8px 12px;border-radius:10px;color:#04121a;font-weight:800;cursor:pointer} .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.03);color:var(--muted)} 
    .feed{display:flex;flex-direction:column} .post{background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));padding:14px;border-radius:14px;margin-bottom:12px;border:1px solid rgba(255,255,255,0.02)} 
    .post .meta{display:flex;gap:12px;align-items:flex-start} .post .meta .who{display:flex;flex-direction:column} .post .content{margin-top:10px;line-height:1.45} 
    .post img.media{width:100%;border-radius:12px;margin-top:12px;max-height:420px;object-fit:cover} .post .meta small{color:var(--muted)} .post .actions{display:flex;align-items:center;gap:10px;margin-top:10px} .action{display:inline-flex;gap:8px;align-items:center;padding:8px;border-radius:10px;cursor:pointer} .action.like.active{background:rgba(124,92,255,0.12)} 
    .suggestion{display:flex;align-items:center;justify-content:space-between;padding:8px;border-radius:10px;margin-bottom:8px} .profile-mini{display:flex;gap:10px;align-items:center} 
    .notif-panel{max-height:320px;overflow:auto} .notif-item{padding:10px;border-radius:10px;background:rgba(255,255,255,0.01);margin-bottom:8px} 
    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(2,6,23,0.6);z-index:200} .modal .card{background:var(--panel);padding:18px;border-radius:14px;max-width:600px;width:100%} 
    @media (max-width:980px){main.app{grid-template-columns:1fr;padding:12px} .panel.right{display:none}}
  </style>
</head>
<body>
  <header class="topbar">
    <div class="brand"><div class="mark">S</div><h1>Shadow</h1></div>
    <div class="top-actions">
      <button class="icon-btn" id="btnHome">üè†</button>
      <button class="icon-btn" id="btnFeed">üì∞</button>
      <button class="icon-btn notif-count" id="btnNotif">üîî<span id="notifBadge" style="display:none">0</span></button>
      <button class="icon-btn" id="btnProfile">üë§</button>
    </div>
  </header>

  <main class="app">
    <!-- left panel -->
    <aside class="panel left">
      <div class="profile-compact">
        <div class="avatar">SN</div>
        <div>
          <div style="font-weight:800">Sebasti√°n N.</div>
          <div class="muted">@sebastian</div>
        </div>
      </div>
      <div class="nav-list" style="margin-top:14px">
        <div class="nav-item active" data-target="home">Inicio</div>
        <div class="nav-item" data-target="feed">Feed</div>
        <div class="nav-item" data-target="notifications">Notificaciones</div>
        <div class="nav-item" data-target="profiles">Perfiles</div>
      </div>
      <hr style="border:none;border-top:1px solid rgba(255,255,255,0.02);margin:12px 0">
      <div>
        <div style="font-weight:700">Tu actividad</div>
        <div class="muted" id="stats">Publicaciones: 0 ‚Ä¢ Seguidores: 0</div>
      </div>
    </aside>

    <!-- main content -->
    <section>
      <!-- HOME -->
      <div id="home" class="panel active-section">
        <h2>Inicio</h2>
        <p class="muted">Crea una publicaci√≥n y explora ejemplos reales simulados.</p>
        <div class="composer" aria-label="Compositor">
          <textarea id="postText" placeholder="¬øQu√© est√° pasando?"></textarea>
          <div class="row">
            <select id="imageSelect">
              <option value="">Sin imagen</option>
              <option value="https://picsum.photos/900/420?random=11">Atardecer</option>
              <option value="https://picsum.photos/900/420?random=22">Calle</option>
              <option value="https://picsum.photos/900/420?random=33">Monta√±as</option>
              <option value="https://picsum.photos/900/420?random=44">Arquitectura</option>
            </select>
            <button class="btn" id="publish">Publicar</button>
            <button class="btn ghost" id="clear">Limpiar</button>
          </div>
        </div>
        <h3 style="margin-top:16px">Perfiles destacados</h3>
        <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:8px" id="featuredProfiles"></div>
      </div>

      <!-- FEED -->
      <div id="feed" class="panel" style="display:none">
        <h2>Feed</h2>
        <div id="feedList" class="feed" aria-live="polite"></div>
      </div>

      <!-- NOTIFICATIONS -->
      <div id="notifications" class="panel" style="display:none">
        <h2>Notificaciones</h2>
        <div class="notif-panel" id="notifPanel"></div>
      </div>

      <!-- PROFILES -->
      <div id="profiles" class="panel" style="display:none">
        <h2>Perfiles</h2>
        <div id="profilesList"></div>
      </div>
    </section>

    <!-- right panel -->
    <aside class="panel right">
      <h3>Sugerencias</h3>
      <div class="suggestion" id="suggestion1"></div>
      <hr style="border:none;border-top:1px solid rgba(255,255,255,0.02);margin:12px 0">
      <h4>Actividad reciente</h4>
      <div id="recentActivity" class="muted">Cargando actividad...</div>
    </aside>
  </main>

  <!-- modal perfil -->
  <div id="modal" class="modal">
    <div class="card">
      <button id="closeModal" style="float:right" class="btn ghost">Cerrar</button>
      <div id="modalContent"></div>
    </div>
  </div>

  <script>
    const API_BASE = 'http://127.0.0.1:8000';

    const sampleProfiles = [
      {id:1,name:'Alicia',user:'alicia',bio:'Fot√≥grafa. Capturando amaneceres y caf√©.',followers:1240,following:210},
      {id:2,name:'Marcos',user:'marcos',bio:'Dev frontend, amante del synthwave.',followers:980,following:300},
      {id:3,name:'Sof√≠a',user:'sofia',bio:'Dise√±adora. Colores y tipograf√≠as.',followers:560,following:180}
    ];

    let posts = [];
    let notifications = [];
    let followers = {};

    const navItems = document.querySelectorAll('.nav-item');
    const sections = {
      home:document.getElementById('home'),
      feed:document.getElementById('feed'),
      notifications:document.getElementById('notifications'),
      profiles:document.getElementById('profiles')
    };
    const feedList = document.getElementById('feedList');
    const notifPanel = document.getElementById('notifPanel');
    const notifBadge = document.getElementById('notifBadge');
    const profilesList = document.getElementById('profilesList');
    const recentActivity = document.getElementById('recentActivity');
    const featuredProfiles = document.getElementById('featuredProfiles');

    function switchTo(target){
      Object.values(sections).forEach(s=>s.style.display='none');
      sections[target].style.display='block';
      navItems.forEach(n=>n.classList.toggle('active', n.dataset.target===target));
    }
    navItems.forEach(n=>n.addEventListener('click',()=>switchTo(n.dataset.target)));
    document.getElementById('btnHome').addEventListener('click',()=>switchTo('home'));
    document.getElementById('btnFeed').addEventListener('click',()=>switchTo('feed'));
    document.getElementById('btnNotif').addEventListener('click',()=>switchTo('notifications'));

    function escapeHtml(text){ return text.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

    async function loadPosts(){
      try{
        const res = await fetch(`${API_BASE}/posts`);
        posts = await res.json();
        renderFeed();
      } catch(err){ console.error('Error cargando posts:', err);}
    }

    function renderFeed(){
      feedList.innerHTML='';
      posts.slice().reverse().forEach(p=>{
        const node = document.createElement('article');
        node.className='post';
        node.dataset.id = p.id;
        node.innerHTML = `
          <div class="meta">
            <div class="avatar">${p.user[0].toUpperCase()}</div>
            <div class="who"><strong>${p.user}</strong><small class="muted"> ‚Ä¢ ${p.time||'Ahora'}</small></div>
            <div style="margin-left:auto;color:var(--muted);font-size:13px">ID:${p.id}</div>
          </div>
          <div class="content">${escapeHtml(p.text)}</div>
          ${p.image? `<img class='media' src='${p.image}' alt='media'>` : ''}
          <div class="actions">
            <div class="action like" data-id="${p.id}">‚ù§Ô∏è <span class='likes'>${p.likes||0}</span></div>
            <div class="action comment">üí¨ <span class='comments'>${p.comments||0}</span></div>
            <div class="action share">üîó</div>
            <div style="margin-left:auto;display:flex;gap:8px">
              <button class='btn ghost btnOpenProfile' data-user='${p.user}'>Perfil</button>
              <button class='btn ghost btnDelete' data-id='${p.id}'>Eliminar</button>
            </div>
          </div>
        `;
        feedList.appendChild(node);
      });
      updateStats();
    }

    function updateStats(){
      document.getElementById('stats').textContent = `Publicaciones: ${posts.length} ‚Ä¢ Seguidores: ${Object.keys(followers).length}`;
    }

    document.getElementById('publish').addEventListener('click', async ()=>{
      const txt = document.getElementById('postText').value.trim();
      const img = document.getElementById('imageSelect').value;
      if(!txt) return alert('Escribe algo antes de publicar');

      const newPost = {user:'Sebasti√°n', text:txt, image:img||''};
      try{
        const res = await fetch(`${API_BASE}/posts`, {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body:JSON.stringify(newPost)
        });
        const savedPost = await res.json();
        posts.push(savedPost);
        renderFeed();
        document.getElementById('postText').value='';
        document.getElementById('imageSelect').value='';
        switchTo('feed');
      } catch(err){ console.error('Error publicando:',err);}
    });

    document.getElementById('clear').addEventListener('click',()=>{
      document.getElementById('postText').value='';
      document.getElementById('imageSelect').value='';
    });

    function boot(){ loadPosts(); }
    boot();
  </script>
</body>
</html>
